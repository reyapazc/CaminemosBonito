<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Caminemos bonito</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body, html {
            height: 100vh;
            margin: 0;
            background-color: #ffe6e6;
            overflow: hidden;
        }

        /* Contenedor principal */
        #appContainer {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            width: 100%;
            height: 100%;
            text-align: center;
            position: relative;
        }

        .hidden { display: none; }

        /* TRANSICIONES ENTRE PANTALLAS */
        .screen {
            opacity: 0;
            transition: opacity 0.8s ease;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        .active {
            opacity: 1;
            position: absolute;
        }

        /* PUZZLE */
        .puzzle-container {
            display: grid;
            grid-template-columns: repeat(3, 100px);
            grid-template-rows: repeat(3, 100px);
            gap: 5px;
        }
        .puzzle-piece {
            width: 100px;
            height: 100px;
            background-size: 300px 300px;
            cursor: pointer;
            border: 1px solid #000;
        }
        .selected {
            border: 3px solid red !important;
        }

        .nav-btn {
            font-size: 1.5rem;
            border-radius: 50%;
            width: 55px;
            height: 55px;
            padding: 0;
        }

        /* Estilo de imagen tipo cover */
        img.song-cover {
            width: 180px;
            height: 180px;
            border-radius: 12px;
            object-fit: cover;
            margin-bottom: 15px;
            box-shadow: 0 0 10px #ff9b9b;
            animation: fadeIn 1.2s ease;
        }

        /* Corazones cayendo */
        .heart {
            position: fixed;
            top: -10px;
            font-size: 20px;
            color: #ff4d6d;
            animation: fall 4s linear infinite;
            opacity: 0.8;
        }
        @keyframes fall {
            0% { transform: translateY(-10vh) translateX(0); }
            100% { transform: translateY(110vh) translateX(20px); }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }
    </style>
</head>
<body>

<div id="appContainer">

<!-- ==========================
     PANTALLA 1: ROMPECABEZAS
============================== -->
<div id="screen1" class="screen active">
    <h1 class="text-danger">Primero un rompecabezas</h1>
    <p>Para descubrir lo que tengo para ti, primero este rompecabezas debes unir.</p>

    <div class="d-flex justify-content-center align-items-center w-100">
        <div class="puzzle-container" id="puzzleContainer"></div>
    </div>
</div>

<!-- ==========================
     PANTALLA 2
============================== -->
<div id="screen2" class="screen hidden">
    <h1 class="text-danger">D√©jame pintar tu cielo</h1>

    <!-- Imagen completa aqu√≠ -->
    <img src="image.jpg" class="song-cover" alt="Rompecabezas completo">

    <p id="mensaje1" class="mt-3">
        Lo lograste mi amor, lo armaste.<br>
        Ahora probablemente te preguntes por qu√© la noche estrellada...<br>
        D√©jame pintar tu cielo mi amor.
    </p>

    <button class="btn btn-danger nav-btn" onclick="nextScreen(3)">‚û°</button>
</div>

<!-- ==========================
     PANTALLA 3: M√öSICA
============================== -->
<div id="screen3" class="screen hidden">
    <h1 class="text-danger">Ahora una canci√≥n</h1>

    <img src="song.jpg" class="song-cover" alt="Portada de la canci√≥n">

    <h3 id="songTitle" class="mt-2">Caminar bonito</h3>
    <p id="songArtist" class="text-muted">Natalia Lafourcade</p>

    <audio controls>
        <source src="song.mp3" type="audio/mp3">
        Tu navegador no soporta audio.
    </audio>

    <p id="songMessage" class="mt-3">
        Aqu√≠ puedes poner un mensaje sobre la canci√≥n...
    </p>

    <div class="mt-4 d-flex justify-content-center gap-4">
        <button class="btn btn-danger nav-btn" onclick="nextScreen(2)">‚¨Ö</button>
        <button class="btn btn-danger nav-btn" onclick="nextScreen(4)">‚û°</button>
    </div>
</div>

<!-- ==========================
     PANTALLA 4
============================== -->
<div id="screen4" class="screen hidden">
    <h1 class="text-danger">Caminemos bonito</h1>
    <p id="mensaje2">
        Cada d√≠a yo elijo, pues la vida son monta√±as que quiero atravesar juntitos
    </p>

    <button class="btn btn-danger nav-btn" onclick="nextScreen(3)">‚¨Ö</button>
</div>

</div>

<script>
/* =========================
   TRANSICI√ìN ENTRE PANTALLAS
========================= */
function nextScreen(n) {
    document.querySelectorAll('.screen').forEach(s => {
        s.classList.remove('active');
        s.classList.add('hidden');
    });
    const screen = document.getElementById('screen' + n);
    screen.classList.remove('hidden');
    screen.classList.add('active');
}

/* =========================
   ROMPECABEZAS
========================= */
const imageUrl = "image.jpg";
let positions = [0,1,2,3,4,5,6,7,8].sort(() => Math.random() - 0.5);
let selectedPiece = null;

function createPuzzle() {
    const container = document.getElementById("puzzleContainer");
    container.innerHTML = '';

    positions.forEach((pos, index) => {
        const piece = document.createElement("div");
        piece.classList.add("puzzle-piece");
        piece.style.backgroundImage = `url(${imageUrl})`;
        piece.style.backgroundPosition = `-${(pos % 3) * 100}px -${Math.floor(pos / 3) * 100}px`;

        piece.onclick = () => selectPiece(index, piece);
        container.appendChild(piece);
    });
}

function selectPiece(index, element) {
    if (!selectedPiece) {
        selectedPiece = { index, element };
        element.classList.add("selected");
    } else {
        swapPieces(selectedPiece.index, index);
        selectedPiece.element.classList.remove("selected");
        selectedPiece = null;
        checkWin();
    }
}

function swapPieces(a, b) {
    [positions[a], positions[b]] = [positions[b], positions[a]];
    createPuzzle();
}

/* CONFETI + CORAZONES AL COMPLETAR */
function checkWin() {
    if (positions.every((p, i) => p === i)) {
        launchConfetti();
        startHearts();
        setTimeout(() => nextScreen(2), 1000);
    }
}

createPuzzle();

/* =========================
   CONFETI
========================= */
function launchConfetti() {
    for (let i = 0; i < 50; i++) {
        const conf = document.createElement('div');
        conf.innerHTML = "üéâ";
        conf.style.position = 'fixed';
        conf.style.left = Math.random() * 100 + 'vw';
        conf.style.top = '-10px';
        conf.style.fontSize = '25px';
        conf.style.animation = `fall 3s linear infinite`;
        document.body.appendChild(conf);
        setTimeout(() => conf.remove(), 3000);
    }
}

/* =========================
   CORAZONES
========================= */
function startHearts() {
    for (let i = 0; i < 30; i++) {
        const heart = document.createElement('div');
        heart.classList.add('heart');
        heart.innerHTML = "‚ù§Ô∏è";
        heart.style.left = Math.random() * 100 + 'vw';
        heart.style.animationDuration = (3 + Math.random() * 3) + 's';
        document.body.appendChild(heart);
        setTimeout(() => heart.remove(), 6000);
    }
}
</script>

</body>
</html>

<!-- üì± CSS RESPONSIVE A√ëADIDO -->
<style>
/* Ajuste general para tama√±os peque√±os */
@media (max-width: 480px) {
    h1 {
        font-size: 1.4rem !important;
    }
    p {
        font-size: 0.95rem !important;
    }
    .song-cover {
        width: 130px !important;
        height: 130px !important;
    }
    .nav-btn {
        width: 45px !important;
        height: 45px !important;
        font-size: 1.2rem !important;
    }
    /* Puzzle m√°s peque√±o en m√≥viles */
    .puzzle-container {
        grid-template-columns: repeat(3, 80px) !important;
        grid-template-rows: repeat(3, 80px) !important;
    }
    .puzzle-piece {
        width: 80px !important;
        height: 80px !important;
        background-size: 240px 240px !important;
    }
}

/* Ultra peque√±o (pantallas muy chicas) */
@media (max-width: 360px) {
    .puzzle-container {
        grid-template-columns: repeat(3, 70px) !important;
        grid-template-rows: repeat(3, 70px) !important;
    }
    .puzzle-piece {
        width: 70px !important;
        height: 70px !important;
        background-size: 210px 210px !important;
    }
    .song-cover {
        width: 110px !important;
        height: 110px !important;
    }
}
</style>

